task name: anaphor_gender_agreement
prune weight: False
prune edge: True
optimize weight completeness: True
optimize edge completeness: True
/home/leiyu/py310/lib/python3.10/site-packages/torch/nn/functional.py:2919: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 0. mean pruned model eval accuracy: 1.00,mean eval kl-div: 0.0000,weight density: 0.0308,edge density: 1.0000
  0%|                                                                                                                     | 0/100 [00:00<?, ?it/s]Edge pruning epoch 1, discovered circuit accuracy: 0.9850, complementary circuit accuracy: 0.3200, KL: 0.0564, weight density: 0.0308, edge density: 0.4968
  1%|█                                                                                                            | 1/100 [00:05<09:37,  5.84s/it]Edge pruning epoch 2, discovered circuit accuracy: 0.9900, complementary circuit accuracy: 0.3250, KL: 0.0566, weight density: 0.0308, edge density: 0.4177
  2%|██▏                                                                                                          | 2/100 [00:11<09:30,  5.82s/it]Edge pruning epoch 3, discovered circuit accuracy: 0.9900, complementary circuit accuracy: 0.3100, KL: 0.0581, weight density: 0.0308, edge density: 0.3575
  3%|███▎                                                                                                         | 3/100 [00:17<09:27,  5.85s/it]Edge pruning epoch 4, discovered circuit accuracy: 0.9900, complementary circuit accuracy: 0.1600, KL: 0.0593, weight density: 0.0308, edge density: 0.3021
  4%|████▎                                                                                                        | 4/100 [00:23<09:22,  5.86s/it]Edge pruning epoch 5, discovered circuit accuracy: 0.9900, complementary circuit accuracy: 0.1600, KL: 0.0584, weight density: 0.0308, edge density: 0.2511
  5%|█████▍                                                                                                       | 5/100 [00:29<09:17,  5.87s/it]Edge pruning epoch 6, discovered circuit accuracy: 0.9900, complementary circuit accuracy: 0.1600, KL: 0.0613, weight density: 0.0308, edge density: 0.2053
  6%|██████▌                                                                                                      | 6/100 [00:35<09:13,  5.88s/it]Edge pruning epoch 7, discovered circuit accuracy: 0.9950, complementary circuit accuracy: 0.1600, KL: 0.0589, weight density: 0.0308, edge density: 0.1663
  7%|███████▋                                                                                                     | 7/100 [00:41<09:05,  5.87s/it]Edge pruning epoch 8, discovered circuit accuracy: 0.9950, complementary circuit accuracy: 0.1600, KL: 0.0560, weight density: 0.0308, edge density: 0.1349
  8%|████████▋                                                                                                    | 8/100 [00:46<09:00,  5.87s/it]Edge pruning epoch 9, discovered circuit accuracy: 0.9950, complementary circuit accuracy: 0.1600, KL: 0.0561, weight density: 0.0308, edge density: 0.1108
  9%|█████████▊                                                                                                   | 9/100 [00:52<08:54,  5.87s/it]Edge pruning epoch 10, discovered circuit accuracy: 0.9950, complementary circuit accuracy: 0.1600, KL: 0.0561, weight density: 0.0308, edge density: 0.0908
 10%|██████████▊                                                                                                 | 10/100 [00:58<08:49,  5.88s/it]Edge pruning epoch 11, discovered circuit accuracy: 1.0000, complementary circuit accuracy: 0.1700, KL: 0.0543, weight density: 0.0308, edge density: 0.0756
 11%|███████████▉                                                                                                | 11/100 [01:04<08:43,  5.89s/it]Edge pruning epoch 12, discovered circuit accuracy: 1.0000, complementary circuit accuracy: 0.1600, KL: 0.0536, weight density: 0.0308, edge density: 0.0651
 12%|████████████▉                                                                                               | 12/100 [01:10<08:37,  5.88s/it]Edge pruning epoch 13, discovered circuit accuracy: 0.9900, complementary circuit accuracy: 0.1600, KL: 0.0511, weight density: 0.0308, edge density: 0.0569
 13%|██████████████                                                                                              | 13/100 [01:16<08:31,  5.88s/it]Edge pruning epoch 14, discovered circuit accuracy: 0.9800, complementary circuit accuracy: 0.1600, KL: 0.0550, weight density: 0.0308, edge density: 0.0510
 14%|███████████████                                                                                             | 14/100 [01:22<08:26,  5.89s/it]Edge pruning epoch 15, discovered circuit accuracy: 0.9900, complementary circuit accuracy: 0.1600, KL: 0.0525, weight density: 0.0308, edge density: 0.0469
 15%|████████████████▏                                                                                           | 15/100 [01:28<08:21,  5.90s/it]Edge pruning epoch 16, discovered circuit accuracy: 0.9800, complementary circuit accuracy: 0.1600, KL: 0.0719, weight density: 0.0308, edge density: 0.0424
 16%|█████████████████▎                                                                                          | 16/100 [01:34<08:15,  5.90s/it]Edge pruning epoch 17, discovered circuit accuracy: 0.9700, complementary circuit accuracy: 0.1600, KL: 0.0803, weight density: 0.0308, edge density: 0.0396
 17%|██████████████████▎                                                                                         | 17/100 [01:40<08:11,  5.92s/it]Edge pruning epoch 18, discovered circuit accuracy: 0.8700, complementary circuit accuracy: 0.1600, KL: 0.1875, weight density: 0.0308, edge density: 0.0364
 18%|███████████████████▍                                                                                        | 18/100 [01:45<08:04,  5.91s/it]Edge pruning epoch 19, discovered circuit accuracy: 0.9250, complementary circuit accuracy: 0.1600, KL: 0.0776, weight density: 0.0308, edge density: 0.0339
 19%|████████████████████▌                                                                                       | 19/100 [01:51<07:58,  5.91s/it]Edge pruning epoch 20, discovered circuit accuracy: 0.9400, complementary circuit accuracy: 0.1600, KL: 0.1164, weight density: 0.0308, edge density: 0.0329
 20%|█████████████████████▌                                                                                      | 20/100 [01:57<07:51,  5.89s/it]Edge pruning epoch 21, discovered circuit accuracy: 0.9600, complementary circuit accuracy: 0.1600, KL: 0.0695, weight density: 0.0308, edge density: 0.0316
 21%|██████████████████████▋                                                                                     | 21/100 [02:03<07:45,  5.89s/it]Edge pruning epoch 22, discovered circuit accuracy: 0.9500, complementary circuit accuracy: 0.1600, KL: 0.1554, weight density: 0.0308, edge density: 0.0303
 22%|███████████████████████▊                                                                                    | 22/100 [02:09<07:40,  5.91s/it]Edge pruning epoch 23, discovered circuit accuracy: 0.9800, complementary circuit accuracy: 0.1600, KL: 0.0605, weight density: 0.0308, edge density: 0.0311
 23%|████████████████████████▊                                                                                   | 23/100 [02:15<07:35,  5.92s/it]Edge pruning epoch 24, discovered circuit accuracy: 0.9400, complementary circuit accuracy: 0.1700, KL: 0.1038, weight density: 0.0308, edge density: 0.0311
 24%|█████████████████████████▉                                                                                  | 24/100 [02:21<07:27,  5.89s/it]Edge pruning epoch 25, discovered circuit accuracy: 0.9850, complementary circuit accuracy: 0.1600, KL: 0.0678, weight density: 0.0308, edge density: 0.0303
 25%|███████████████████████████                                                                                 | 25/100 [02:27<07:22,  5.90s/it]Edge pruning epoch 26, discovered circuit accuracy: 0.9800, complementary circuit accuracy: 0.1600, KL: 0.0579, weight density: 0.0308, edge density: 0.0300
 26%|████████████████████████████                                                                                | 26/100 [02:33<07:16,  5.90s/it]Edge pruning epoch 27, discovered circuit accuracy: 0.9800, complementary circuit accuracy: 0.1600, KL: 0.0569, weight density: 0.0308, edge density: 0.0297
 27%|█████████████████████████████▏                                                                              | 27/100 [02:39<07:12,  5.93s/it]Edge pruning epoch 28, discovered circuit accuracy: 0.9200, complementary circuit accuracy: 0.1600, KL: 0.1005, weight density: 0.0308, edge density: 0.0294
 28%|██████████████████████████████▏                                                                             | 28/100 [02:44<07:05,  5.91s/it]Edge pruning epoch 29, discovered circuit accuracy: 0.9450, complementary circuit accuracy: 0.3350, KL: 0.0875, weight density: 0.0308, edge density: 0.0297
 29%|███████████████████████████████▎                                                                            | 29/100 [02:50<06:59,  5.90s/it]Edge pruning epoch 30, discovered circuit accuracy: 0.9450, complementary circuit accuracy: 0.3200, KL: 0.0827, weight density: 0.0308, edge density: 0.0301
 30%|████████████████████████████████▍                                                                           | 30/100 [02:56<06:53,  5.91s/it]Edge pruning epoch 31, discovered circuit accuracy: 0.9450, complementary circuit accuracy: 0.1700, KL: 0.0849, weight density: 0.0308, edge density: 0.0299
 31%|█████████████████████████████████▍                                                                          | 31/100 [03:02<06:47,  5.90s/it]Edge pruning epoch 32, discovered circuit accuracy: 0.9450, complementary circuit accuracy: 0.3150, KL: 0.0891, weight density: 0.0308, edge density: 0.0301
 32%|██████████████████████████████████▌                                                                         | 32/100 [03:08<06:40,  5.89s/it]Edge pruning epoch 33, discovered circuit accuracy: 0.9350, complementary circuit accuracy: 0.3250, KL: 0.0944, weight density: 0.0308, edge density: 0.0304
 33%|███████████████████████████████████▋                                                                        | 33/100 [03:14<06:33,  5.88s/it]Edge pruning epoch 34, discovered circuit accuracy: 0.9250, complementary circuit accuracy: 0.7900, KL: 0.1053, weight density: 0.0308, edge density: 0.0303
 34%|████████████████████████████████████▋                                                                       | 34/100 [03:20<06:27,  5.88s/it]Edge pruning epoch 35, discovered circuit accuracy: 0.9200, complementary circuit accuracy: 0.3250, KL: 0.1256, weight density: 0.0308, edge density: 0.0307
 35%|█████████████████████████████████████▊                                                                      | 35/100 [03:26<06:21,  5.87s/it]Edge pruning epoch 36, discovered circuit accuracy: 0.9300, complementary circuit accuracy: 0.3250, KL: 0.0968, weight density: 0.0308, edge density: 0.0311
 36%|██████████████████████████████████████▉                                                                     | 36/100 [03:31<06:16,  5.88s/it]Edge pruning epoch 37, discovered circuit accuracy: 0.9350, complementary circuit accuracy: 0.8100, KL: 0.0790, weight density: 0.0308, edge density: 0.0311
 37%|███████████████████████████████████████▉                                                                    | 37/100 [03:37<06:09,  5.87s/it]Edge pruning epoch 38, discovered circuit accuracy: 0.8950, complementary circuit accuracy: 0.1600, KL: 0.1272, weight density: 0.0308, edge density: 0.0323
 38%|█████████████████████████████████████████                                                                   | 38/100 [03:43<06:04,  5.88s/it]Edge pruning epoch 39, discovered circuit accuracy: 0.8950, complementary circuit accuracy: 0.1650, KL: 0.1250, weight density: 0.0308, edge density: 0.0331
 39%|██████████████████████████████████████████                                                                  | 39/100 [03:49<05:58,  5.87s/it]Edge pruning epoch 40, discovered circuit accuracy: 0.9450, complementary circuit accuracy: 0.1600, KL: 0.0937, weight density: 0.0308, edge density: 0.0336
 40%|███████████████████████████████████████████▏                                                                | 40/100 [03:55<05:54,  5.91s/it]Edge pruning epoch 41, discovered circuit accuracy: 0.9050, complementary circuit accuracy: 0.1600, KL: 0.1342, weight density: 0.0308, edge density: 0.0351
 41%|████████████████████████████████████████████▎                                                               | 41/100 [04:01<05:48,  5.91s/it]Edge pruning epoch 42, discovered circuit accuracy: 0.8900, complementary circuit accuracy: 0.1600, KL: 0.1540, weight density: 0.0308, edge density: 0.0365
 42%|█████████████████████████████████████████████▎                                                              | 42/100 [04:07<05:42,  5.90s/it]Edge pruning epoch 43, discovered circuit accuracy: 0.9100, complementary circuit accuracy: 0.1600, KL: 0.1396, weight density: 0.0308, edge density: 0.0376
 43%|██████████████████████████████████████████████▍                                                             | 43/100 [04:13<05:36,  5.90s/it]Edge pruning epoch 44, discovered circuit accuracy: 0.9250, complementary circuit accuracy: 0.1600, KL: 0.1036, weight density: 0.0308, edge density: 0.0382
 44%|███████████████████████████████████████████████▌                                                            | 44/100 [04:19<05:30,  5.90s/it]Edge pruning epoch 45, discovered circuit accuracy: 0.9100, complementary circuit accuracy: 0.1600, KL: 0.1217, weight density: 0.0308, edge density: 0.0392
 45%|████████████████████████████████████████████████▌                                                           | 45/100 [04:25<05:24,  5.90s/it]Edge pruning epoch 46, discovered circuit accuracy: 0.9100, complementary circuit accuracy: 0.7700, KL: 0.1172, weight density: 0.0308, edge density: 0.0410
 46%|█████████████████████████████████████████████████▋                                                          | 46/100 [04:30<05:18,  5.89s/it]Edge pruning epoch 47, discovered circuit accuracy: 0.9550, complementary circuit accuracy: 0.1600, KL: 0.0704, weight density: 0.0308, edge density: 0.0423
 47%|██████████████████████████████████████████████████▊                                                         | 47/100 [04:36<05:12,  5.89s/it]Edge pruning epoch 48, discovered circuit accuracy: 0.9550, complementary circuit accuracy: 0.1600, KL: 0.0741, weight density: 0.0308, edge density: 0.0434
 48%|███████████████████████████████████████████████████▊                                                        | 48/100 [04:42<05:05,  5.87s/it]Edge pruning epoch 49, discovered circuit accuracy: 0.9500, complementary circuit accuracy: 0.1700, KL: 0.0777, weight density: 0.0308, edge density: 0.0445
 49%|████████████████████████████████████████████████████▉                                                       | 49/100 [04:48<04:59,  5.87s/it]Edge pruning epoch 50, discovered circuit accuracy: 0.9000, complementary circuit accuracy: 0.2100, KL: 0.1210, weight density: 0.0308, edge density: 0.0454
 50%|██████████████████████████████████████████████████████                                                      | 50/100 [04:54<04:53,  5.88s/it]Edge pruning epoch 51, discovered circuit accuracy: 0.8650, complementary circuit accuracy: 0.8400, KL: 0.1426, weight density: 0.0308, edge density: 0.0460
 51%|███████████████████████████████████████████████████████                                                     | 51/100 [05:00<04:48,  5.89s/it]Edge pruning epoch 52, discovered circuit accuracy: 0.8750, complementary circuit accuracy: 0.1600, KL: 0.1338, weight density: 0.0308, edge density: 0.0475
 52%|████████████████████████████████████████████████████████▏                                                   | 52/100 [05:06<04:42,  5.89s/it]Edge pruning epoch 53, discovered circuit accuracy: 0.8900, complementary circuit accuracy: 0.3700, KL: 0.1336, weight density: 0.0308, edge density: 0.0494
 53%|█████████████████████████████████████████████████████████▏                                                  | 53/100 [05:12<04:36,  5.87s/it]Edge pruning epoch 54, discovered circuit accuracy: 0.9250, complementary circuit accuracy: 0.1600, KL: 0.1029, weight density: 0.0308, edge density: 0.0504
 54%|██████████████████████████████████████████████████████████▎                                                 | 54/100 [05:17<04:29,  5.86s/it]Edge pruning epoch 55, discovered circuit accuracy: 0.9000, complementary circuit accuracy: 0.4750, KL: 0.1199, weight density: 0.0308, edge density: 0.0518
 55%|███████████████████████████████████████████████████████████▍                                                | 55/100 [05:23<04:23,  5.87s/it]Edge pruning epoch 56, discovered circuit accuracy: 0.9350, complementary circuit accuracy: 0.6850, KL: 0.0954, weight density: 0.0308, edge density: 0.0537
 56%|████████████████████████████████████████████████████████████▍                                               | 56/100 [05:29<04:18,  5.87s/it]Edge pruning epoch 57, discovered circuit accuracy: 0.9200, complementary circuit accuracy: 0.7950, KL: 0.1164, weight density: 0.0308, edge density: 0.0554
 57%|█████████████████████████████████████████████████████████████▌                                              | 57/100 [05:35<04:12,  5.86s/it]Edge pruning epoch 58, discovered circuit accuracy: 0.9250, complementary circuit accuracy: 0.8400, KL: 0.0957, weight density: 0.0308, edge density: 0.0576
 58%|██████████████████████████████████████████████████████████████▋                                             | 58/100 [05:41<04:05,  5.85s/it]Edge pruning epoch 59, discovered circuit accuracy: 0.9200, complementary circuit accuracy: 0.8050, KL: 0.1034, weight density: 0.0308, edge density: 0.0606
 59%|███████████████████████████████████████████████████████████████▋                                            | 59/100 [05:47<04:00,  5.86s/it]Edge pruning epoch 60, discovered circuit accuracy: 0.9650, complementary circuit accuracy: 0.8100, KL: 0.0606, weight density: 0.0308, edge density: 0.0633
 60%|████████████████████████████████████████████████████████████████▊                                           | 60/100 [05:53<03:55,  5.89s/it]Edge pruning epoch 61, discovered circuit accuracy: 0.9650, complementary circuit accuracy: 0.8400, KL: 0.0612, weight density: 0.0308, edge density: 0.0655
 61%|█████████████████████████████████████████████████████████████████▉                                          | 61/100 [05:58<03:47,  5.83s/it]Edge pruning epoch 62, discovered circuit accuracy: 0.9700, complementary circuit accuracy: 0.5250, KL: 0.0579, weight density: 0.0308, edge density: 0.0683
 62%|██████████████████████████████████████████████████████████████████▉                                         | 62/100 [06:04<03:42,  5.85s/it]Edge pruning epoch 63, discovered circuit accuracy: 0.9600, complementary circuit accuracy: 0.6800, KL: 0.0686, weight density: 0.0308, edge density: 0.0703
 63%|████████████████████████████████████████████████████████████████████                                        | 63/100 [06:10<03:37,  5.89s/it]Edge pruning epoch 64, discovered circuit accuracy: 0.9600, complementary circuit accuracy: 0.3250, KL: 0.0760, weight density: 0.0308, edge density: 0.0724
 64%|█████████████████████████████████████████████████████████████████████                                       | 64/100 [06:16<03:32,  5.89s/it]Edge pruning epoch 65, discovered circuit accuracy: 0.9800, complementary circuit accuracy: 0.3250, KL: 0.0550, weight density: 0.0308, edge density: 0.0744
 65%|██████████████████████████████████████████████████████████████████████▏                                     | 65/100 [06:22<03:25,  5.88s/it]Edge pruning epoch 66, discovered circuit accuracy: 0.9800, complementary circuit accuracy: 0.1600, KL: 0.0547, weight density: 0.0308, edge density: 0.0766
 66%|███████████████████████████████████████████████████████████████████████▎                                    | 66/100 [06:28<03:20,  5.89s/it]Edge pruning epoch 67, discovered circuit accuracy: 0.9650, complementary circuit accuracy: 0.3250, KL: 0.0675, weight density: 0.0308, edge density: 0.0822
 67%|████████████████████████████████████████████████████████████████████████▎                                   | 67/100 [06:34<03:14,  5.89s/it]Edge pruning epoch 68, discovered circuit accuracy: 0.9600, complementary circuit accuracy: 0.1700, KL: 0.0691, weight density: 0.0308, edge density: 0.0847
 68%|█████████████████████████████████████████████████████████████████████████▍                                  | 68/100 [06:40<03:08,  5.89s/it]Edge pruning epoch 69, discovered circuit accuracy: 0.9650, complementary circuit accuracy: 0.2100, KL: 0.0621, weight density: 0.0308, edge density: 0.0900
 69%|██████████████████████████████████████████████████████████████████████████▌                                 | 69/100 [06:46<03:02,  5.89s/it]Edge pruning epoch 70, discovered circuit accuracy: 0.9500, complementary circuit accuracy: 0.3250, KL: 0.0644, weight density: 0.0308, edge density: 0.0942
 70%|███████████████████████████████████████████████████████████████████████████▌                                | 70/100 [06:54<02:57,  5.92s/it]^C